# 实验记录



## 2024年7月3日

### 1. 关键词

​	EEG时间序列建模、自回归层结构液态机

### 2. 归档文件

1. 源代码： [SNN_pkg_07031834.tar.gz](src_files/history/SNN_pkg_07031834.tar.gz)
2. STDP液态机模型及实验数据： [STDP_model_07031659.tar.gz](model/STDP/EEG/STDP_model_07031659.tar.gz) 
3. 回归分类器及实验数据： [Reg_model_07031936.tar.gz](model/Regression/Reg_model_07031936.tar.gz) 

### 3. 实验结果

​	STDP及Regression两部分代码已全部跑通。

​	编码上，对DEAP脑电数据集取前14个通道（未必是适用于情感计算的通道），并以0为界，编码为脉冲序列。液态机方面，按原先设计，设置三个自连接突触，导致训练时三个LIF层神经元脉冲发放率均为100%；遂去掉前两层的自回归突触，保留第三层，成功使脉冲发放稀疏化。经59条相互独立的数据处理后，各层$C_l$值收敛至$10^{-5}$以下。

​	训练过程中，$C_l$值变化如下图：

![cl](/home/xiangnan/Files/code/SNN/Emotion-Recognition-based-on-SNN/Network/model/STDP/EEG/STDP_model_07031659/cl.jpg)

​	脉冲发放率变化如下图（仅对一条数据最后一个时间步所诱发的脉冲发放进行采样）：

![firing_rate](/home/xiangnan/Files/code/SNN/Emotion-Recognition-based-on-SNN/Network/model/STDP/EEG/STDP_model_07031659/firing_rate.jpg)

​	随机选取三条相互独立的数据，记录每个时间步所诱发的脉冲发放率。时间步7800后，脉冲发放率变化如下图所示：

![3_sample_test](/home/xiangnan/Files/code/SNN/Emotion-Recognition-based-on-SNN/Network/model/STDP/EEG/STDP_model_07031659/3_sample_test.jpg)

​	可以看到，数据间脉冲发放有较大差异性，这说明该液态机可能实现了特征提取。

​	但问题在于，由训练期间脉冲发放率变化图所示，每条数据最后一个时间步都会导致最后一层脉冲发放。因此，在回归时，改设最后一层LIF的阈值尽可能大，使之全程不发放脉冲，这相当于取消了最后一层的自回归结构。连接液态机与回归分类器，进行训练，训练过程中各项指标如下图所示：

![reg_result](/home/xiangnan/Files/code/SNN/Emotion-Recognition-based-on-SNN/Network/model/Regression/Reg_model_07031936/reg_result.jpg)

​	上述结果是171条数据的训练所得，每5条数据进行一次统计，仅用一条数据作为测试集，因此测试集统计结果可忽略。训练集准确率虽有上升趋势，但损失几乎没有下降。

### 4. 现存问题

1. 模型过大：

​	液态机训练需要25.9G左右的显存，液态机+分类器训练需要50G左右的显存（这还是取消了液态机前馈中所有自循环结构的结果）。目前，液态机需要用RTX 3090训练，液态机+分类器需要用RTX A6000训练。计划在模型效果得到保证后，针对液态机作剪枝处理（因为按现用STDP规则，存在大量0突触）。

2. 最后一层LIF脉冲发放率过度离散化：

​	最后一层采用了500个神经元，但脉冲发放率分布相当离散，这说明最后一层内部，各神经元间差异极小，这很可能导致它无法携带有效信息，从而导致了不理想的分类结果。目前推测这很可能是模型过深所导致的。计划下一步减少模型层次。
